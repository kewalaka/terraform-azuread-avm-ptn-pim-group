<!-- BEGIN_TF_DOCS -->
<!-- Code generated by terraform-docs. DO NOT EDIT. -->
# Non-Role-Assignable Group Example with Nested Eligibility

This example demonstrates creating a standard Entra ID security group (not role-assignable) with PIM (Privileged Identity Management) enabled, using a nested group for eligibility management.

## Why use this pattern?

- **Avoid Limits**: Entra ID has a hard limit of 500 role-assignable groups per tenant. Standard groups do not have this limit.
- **Resource Access**: These groups work perfectly for Azure Resource RBAC (e.g., Contributor on a Subscription).
- **Limitations**: These groups **cannot** be assigned Entra ID roles (e.g., Global Administrator, User Administrator).
- **Scalability**: By making a standard "Operations Team" group eligible, you can manage PIM eligibility simply by adding or removing users from that group.

## What the example builds

- A standard security group (`assignable_to_role = false`) as the PIM-enabled group.
- An "Operations Team" group that is assigned as an eligible member.
- An operator user who is a member of the Operations Team.
- PIM onboarding is triggered automatically by the eligible member assignment.

```hcl
terraform {
  required_version = "~> 1.0"

  required_providers {
    azuread = {
      source  = "hashicorp/azuread"
      version = "~> 3.0"
    }
    azurerm = {
      source  = "hashicorp/azurerm"
      version = "~> 4.0"
    }
    random = {
      source  = "hashicorp/random"
      version = "~> 3.6"
    }
  }
}

provider "azuread" {}

provider "azurerm" {
  features {}
}

data "azurerm_client_config" "current" {}

data "azuread_domains" "current" {
  only_initial = false
}

locals {
  subscription_scope = "/subscriptions/${data.azurerm_client_config.current.subscription_id}"
  tenant_domain = coalesce(
    try([
      for domain in data.azuread_domains.current.domains : domain.domain_name
      if domain.is_default
    ][0], null),
    data.azuread_domains.current.domains[0].domain_name
  )
}

resource "random_string" "group_suffix" {
  length  = 4
  numeric = true
  special = false
  upper   = false
}

resource "random_password" "owner" {
  length  = 30
  special = true
}

resource "azuread_user" "owner" {
  display_name          = "PAG Example Owner ${random_string.group_suffix.result}"
  user_principal_name   = "pag-example-owner${random_string.group_suffix.result}@${local.tenant_domain}"
  account_enabled       = true
  force_password_change = true
  mail_nickname         = "pagexowner${random_string.group_suffix.result}"
  password              = random_password.owner.result
}

resource "random_password" "operator" {
  length  = 30
  special = true
}

resource "azuread_user" "operator" {
  display_name          = "PAG Example Operator ${random_string.group_suffix.result}"
  user_principal_name   = "pag-example-operator${random_string.group_suffix.result}@${local.tenant_domain}"
  account_enabled       = true
  force_password_change = true
  mail_nickname         = "pagexoperator${random_string.group_suffix.result}"
  password              = random_password.operator.result
}

resource "azuread_group" "operations_team" {
  display_name     = "PAG Example Operations Team ${random_string.group_suffix.result}"
  mail_enabled     = false
  mail_nickname    = "pagexops${random_string.group_suffix.result}"
  owners           = [azuread_user.owner.object_id]
  security_enabled = true
}

resource "azuread_group_member" "operations_team_member" {
  group_object_id  = azuread_group.operations_team.object_id
  member_object_id = azuread_user.operator.object_id
}

module "privileged_group" {
  source = "../.."

  name = "pag-non-role-assignable-${random_string.group_suffix.result}"
  # PIM onboarding happens automatically when you configure eligible members or PIM policy rules.
  # This example creates an eligible member assignment, which triggers PIM onboarding.
  eligible_members  = [azuread_group.operations_team.object_id]
  group_description = "Standard security group (not role-assignable) with PIM eligibility."
  group_settings = {
    assignable_to_role = false
    security_enabled   = true
    mail_enabled       = false
    owners             = [azuread_user.owner.object_id]
  }
}
```

<!-- markdownlint-disable MD033 -->
## Requirements

The following requirements are needed by this module:

- <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) (~> 1.0)

- <a name="requirement_azuread"></a> [azuread](#requirement\_azuread) (~> 3.0)

- <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm) (~> 4.0)

- <a name="requirement_random"></a> [random](#requirement\_random) (~> 3.6)

## Resources

The following resources are used by this module:

- [azuread_group.operations_team](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/resources/group) (resource)
- [azuread_group_member.operations_team_member](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/resources/group_member) (resource)
- [azuread_user.operator](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/resources/user) (resource)
- [azuread_user.owner](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/resources/user) (resource)
- [azurerm_role_assignment.example](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) (resource)
- [random_password.operator](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/password) (resource)
- [random_password.owner](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/password) (resource)
- [random_string.group_suffix](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/string) (resource)
- [azuread_domains.current](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/domains) (data source)
- [azurerm_client_config.current](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/client_config) (data source)

<!-- markdownlint-disable MD013 -->
## Required Inputs

No required inputs.

## Optional Inputs

No optional inputs.

## Outputs

No outputs.

## Modules

The following Modules are called:

### <a name="module_privileged_group"></a> [privileged\_group](#module\_privileged\_group)

Source: ../..

Version:

<!-- END_TF_DOCS -->